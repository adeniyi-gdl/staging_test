upstream demo1.localhost {
    server 134.209.191.160;
}

#server {
  #listen 443 ssl;
  #listen 80;
  #server_name test.gdlapi.com.ng;
  #server_tokens off;

 # location /.well-known/acme-challenge/ {
  #    root /var/www/certbot;
 # }
  
  #location / {
  #    return 301 https://$host$request_uri;
 # }
#}

server {
  listen 80;
  listen 443 ssl;
  server_name test.gdlapi.com.ng;
  server_tokens off;

  ssl_certificate /etc/letsencrypt/live/test.gdlapi.com.ng/fullchain.pem;
  ssl_certificate_key  /etc/letsencrypt/live/test.gdlapi.com.ng/privkey.pem;
  ssl_dhparam /etc/ssl/certs/dhparam.pem;
  add_header Strict-Transport-Security "max-age=63072000; includeSubdomains";  
  ssl_trusted_certificate /etc/letsencrypt/live/test.gdlapi.com.ng/fullchain.pem;

  location / {
      return 301 https://$host$request_uri;
  }

  location /v1/usrs/ {
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header   X-Forwarded-Proto  $scheme;
    proxy_set_header   X-Forwarded-For    $proxy_add_x_forwarded_for;
    proxy_pass http://user-service:3080/;
  }
  location /v1/notify/ {
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header   X-Forwarded-Proto  $scheme;
    proxy_set_header   X-Forwarded-For    $proxy_add_x_forwarded_for;
    proxy_pass http://notification-service:3079/;
  }
  location /v1/accts/ {
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header   X-Forwarded-Proto  $scheme;
    proxy_set_header   X-Forwarded-For    $proxy_add_x_forwarded_for;
    proxy_pass http://account-service:3077/;
  }
  location /v1/trans/ {
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header   X-Forwarded-Proto  $scheme;
    proxy_set_header   X-Forwarded-For    $proxy_add_x_forwarded_for;
    proxy_pass http://transaction-service:3075/;
  }
  location /v1/invests/ {
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header   X-Forwarded-Proto  $scheme;
    proxy_set_header   X-Forwarded-For    $proxy_add_x_forwarded_for;
    proxy_pass http://saveinvest-service:3078/;
  }
  location /v1/loans/ {
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header   X-Forwarded-Proto  $scheme;
    proxy_set_header   X-Forwarded-For    $proxy_add_x_forwarded_for;
    proxy_pass http://loan-service:3081/;
  }
  location /v1/hpas/ {
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header   X-Forwarded-Proto  $scheme;
    proxy_set_header   X-Forwarded-For    $proxy_add_x_forwarded_for;
    proxy_pass http://hpa-service:3090/;
  }

  # location /images/ {
  #   proxy_set_header Host $host;
  #   proxy_set_header X-Real-IP $remote_addr;
  #   proxy_set_header   X-Forwarded-Proto  $scheme;
  #   proxy_set_header   X-Forwarded-For    $proxy_add_x_forwarded_for;
  #   proxy_pass http://user-management:3000/images/;
  # }
  # location /documents/ {
  #   proxy_set_header Host $host;
  #   proxy_set_header X-Real-IP $remote_addr;
  #   proxy_set_header   X-Forwarded-Proto  $scheme;
  #   proxy_set_header   X-Forwarded-For    $proxy_add_x_forwarded_for;
  #   proxy_pass http://user-management:3000/documents/;
  # }